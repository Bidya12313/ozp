<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Оформлення заявки на платіж</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    {%block body%}
    <div class="container">
        <div class="header">
            <h1>Оформлення заявки на платіж</h1>
        </div>
        
        <div class="form-group">
            <label for="limit">Поточний ліміт:</label>
            <input type="text" id="limit" value="0.00" readonly>
            <button id="change-limit">Змінити</button>
        </div>

        <div class="form-group">
            <label for="applicant">Заявник:</label>
            <select id="applicant">
                <option>{{declarant}}</option>
            </select>
        </div>

        <div class="form-group">
            <label for="payer">Оберіть платника:</label>
            <select id="payer">
                {%for payer in payers%}
                <option>{{payer}}</option>
                {%endfor%}
            </select>
        </div>

        <div class="form-group">
            <label for="manager">Оберіть керівника:</label>
            <select id="manager">
                {%for director in directors%}
                <option>{{director}}</option>
                {%endfor%}
            </select>
        </div>

        <div class="form-group">
            <label for="recipient">Оберіть отримувача:</label>
            <input type="text" id="recipient" placeholder="Отримувач">
        </div>

        <div class="form-group">
            <label for="category">Оберіть категорію:</label>
            <select id="category">
                {%for category in categories%}
                <option>{{category}}</option>
                {%endfor%}
            </select>
        </div>

        <div class="form-group">
            <label for="amount">Вкажіть суму:</label>
            <input type="number" id="amount" placeholder="Тільки (0-9)">
        </div>

        <div class="form-group">
            <label for="document">Прикріпіть документ:</label>
            <input type="file" id="document">
        </div>

        <div class="form-group">
            <label for="comment">Коментар:</label>
            <textarea id="comment"></textarea>
        </div>

        <div class="container">
            <div class="table-wrapper"> <!-- Додано обгортку -->
                <table id="taxesTable">
                    <thead>
                        <tr>
                            <th>Заявник</th>
                            <th>Платник</th>
                            <th>Керівник</th>
                            <th>Отримувач</th>
                            <th>Сума</th>
                            <th>Категорія</th>
                            <th>Документ</th>
                            <th>Коментар</th>
                            <th>Статус</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for tax in user_taxes %}
                        <tr>
                            <td>{{tax.declarant}}</td>
                            <td>{{tax.payer}}</td>
                            <td>{{tax.director}}</td>
                            <td>{{tax.description}}</td>
                            <td>{{tax.amount}}</td>
                            <td>{{tax.category}}</td>
                            <td>{{tax.document}}</td>
                            <td>{{tax.comment}}</td>
                            <td>{{tax.status}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        
        
        # TODO: create another file to js script 
        <script>
            // Знаходимо таблицю та всі рядки
            const table = document.getElementById('taxesTable');
            const rows = table.getElementsByTagName('tr');
        
            // Додаємо обробник подій на кожен рядок таблиці
            for (let i = 1; i < rows.length; i++) { // Починаємо з 1, щоб пропустити заголовок
                rows[i].addEventListener('click', function() {
                    // Видаляємо клас виділення з усіх рядків
                    for (let j = 1; j < rows.length; j++) {
                        rows[j].classList.remove('highlight');
                    }
        
                    // Додаємо клас виділення до натиснутого рядка
                    rows[i].classList.add('highlight');
        
                    // Отримуємо всі клітинки поточного рядка
                    const cells = rows[i].getElementsByTagName('td');
        
                    // Заповнюємо відповідні поля форм
                    document.getElementById('applicant').value = cells[0].innerText; // Заявник
                    document.getElementById('payer').value = cells[1].innerText; // Платник
                    document.getElementById('manager').value = cells[2].innerText; // Керівник
                    document.getElementById('recipient').value = cells[3].innerText; // Опис (тут, в принципі, не опис, а отримувач)
                    document.getElementById('amount').value = cells[4].innerText; // Сума
                    document.getElementById('category').value = cells[5].innerText; // Категорія
                    document.getElementById('comment').value = cells[7].innerText; // Коментар
                });
            }
        </script>
        

        <div class="form-actions">
            <button id="reset-limit">Обнулити ліміт</button>
            <button id="submit">Відправити</button>
        </div>
    </div> 
    {%endblock%}
</body>
</html>
